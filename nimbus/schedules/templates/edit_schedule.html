<!-- {#% extends "base_async.html" %} -->
{% extends "base.html" %}
{% block headtags %}
    
<link rel="stylesheet" type="text/css" href="/media/css/schedules.css" />
<link rel="stylesheet" type="text/css" href="/media/lib/css/style.css" />
<script type="text/javascript" src="/media/js/procedures.js"></script>
<script type="text/javascript" src="/media/js/schedules.js"></script>
<script type="text/javascript" src="/media/js/jquery-ui-1.7.2.custom.min.js"></script>
<!-- <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script> -->
<style type="text/css">
td{padding: 50px;}
</style>
{% endblock %}

{% block page %}
<!-- TODO: Prever um agendamento já definido. -->
<div class="block withsidebar" id="schedule" style="margin: 0;">
    <div class="block_head">
        <div class="bheadl"></div>
        <div class="bheadr"></div>
        <h2>{{ title }}</h2>
    </div>		<!-- .block_head ends -->
    <div class="block_content">
        <form name="schedule_new" action="/schedules/{{schedule.id}}/edit/" method="post" id="schedule_new">
        <div id="error-box">
            {{ schedule_form.non_field_errors }}
            {{ month_form.non_field_errors }}
            {{ week_form.non_field_errors }}
            {{ day_form.non_field_errors }}
            {{ hour_form.non_field_errors }}
            {{ schedule_form.name.errors }}
            <label>{{ schedule_form.name.label }}:</label> {{ schedule_form.name }}<br/>
			{% if schedule.is_model %}
            <label>Este agendamento é um modelo</label><br/>
				<input type="hidden" name="schedule-is_model" value="1"/>
				Atenção. Sua alteração afetará os seguintes backups:
			{% else %}
				<label> Este agendamento é utilizado por:</label><br/>
			{% endif %}
			{% for procedure in procedures %}
				<li>{{procedure.name}}</li>
			{% endfor %}

        </div>

        <div class="sidebar">
            <ul class="sidemenu">
                <li><a href="#mensal" class="month">Mensal</a>{{ month_form.active }}</li>
                <li><a href="#semanal" class="week">Semanal</a>{{ week_form.active }}</li>
                <li><a href="#diario" class="day">Diário</a>{{ day_form.active }}</li>
                <li><a href="#minuto" class="hour">Hora em hora</a>{{ hour_form.active }}</li>
            </ul>
            <p>Agende a execução deste backup, é possível ativar mais de um agendamento.</p>
        </div>		<!-- .sidebar ends -->
        <div class="sidebar_content" id="mensal">
            <div class="personal_message"><p>Executa o backup em determinados dias do mês, sempre no horário especificado.</p></div>
            <p>
                <table border="0" cellpadding="0" cellspacing="0">
                <tbody>
					<div class="month_error">{{ month_form.days.errors }}</div>
                    <tr><th colspan="5">Dias do Mês</th></tr><tr>
                {% for day in days %}

                <td style="padding: 8px;"><label for="day_{{day}}">
                <input type="checkbox" id="month_day_{{day}}" class="month_checkbox schedule no-style" value="{{day}}"/>
                {{day}}º</label></td>
                    {% if day in end_days %}</tr><tr>{% endif %}
                {% endfor %}
                    <td colspan="5">&nbsp;</td></tr>
                </tbody>
                </table>
                {{ month_form.days }}
			</p>
            <p>
				<div class="month_error">{{ month_form.hour.errors }}</div>
                <label>{{ month_form.hour.label }}</label>
                {{ month_form.hour }}<br/>
                <small>Exemplo: 10:20, 21:35 ou 07:08.</small>
            </p>
            <p>
				<div class="month_error">{{ month_form.level.errors }}</div>
                <label>{{ month_form.level.label }}:</label>
                {{ month_form.level }}<br />
                <small>No backup full é feita uma cópia completa de todos os arquivos "marcados" para backup. No incremental é feita uma cópia apenas das modificações. É importamente sempre manter uma política mista de backups.</small>
            </p>
            <p>
				<input type="submit" class="submit" value="Salvar" /><a href="/procedures/list" class="submit small">Cancelar</a>
            </p>
        </div>		<!-- .sidebar_content ends -->

        <div class="sidebar_content" id="semanal">
            <div class="personal_message"><p>Executa o backup em determinados dias da semana, sempre no horário especificado.</p></div>
            <p>
                <table border="0" cellpadding="0" cellspacing="0">
                <tbody>
					<div class="week_error">{{ week_form.days.errors }}</div>
                    <tr><th colspan="5">Dias da Semana</th></tr><tr>
                {% for key,vlw in weekdays.items %}

                <td style="padding: 8px;"><label for="day_{{day}}">
                <input type="checkbox" id="week_day_{{key}}" name="schedule.weekly.day" value="{{key}}" class="week_checkbox no-style" {% if key in schedule_weekly_day %}checked="checked"{% endif %} />
                {{vlw}}</label></td>
                    </tr><tr>
                {% endfor %}
                    <td colspan="5">&nbsp;</td></tr>
                </tbody>
                </table>
            </p>
                {{ week_form.days }}<br/>
            <p>
				<div class="week_error">{{ week_form.hour.errors }}</div>
                <label>{{ week_form.hour.label }}:</label>
                {{ week_form.hour }}<br />
                <small>Exemplo: 10:20, 21:35 ou 07:08.</small>
            </p>
            <p>
				<div class="week_error">{{ week_form.level.errors }}</div>
                <label>{{ week_form.level.label }}:</label>
                {{ week_form.level }}<br />
                <small>No backup full é feita uma cópia completa de todos os arquivos "marcados" para backup. No incremental é feita uma cópia apenas das modificações. É importamente sempre manter uma política mista de backups.</small>
            </p>
            <p>
				<input type="submit" class="submit" value="Salvar" /><a href="/procedures/list" class="submit small">Cancelar</a>
            </p>
        </div>		<!-- .sidebar_content ends -->

        <div class="sidebar_content" id="diario">
            <div class="personal_message"><p>Executa o backup todos os dias, sempre no horário especificado.</p></div>
            <p>
				<div class="day_error">{{ day_form.hour.errors }}</div>
                <label>{{ day_form.hour.label }}:</label>
                {{ day_form.hour }}<br />
                <small>Exemplo: 10:20, 21:35 ou 07:08.</small>
            </p>
            <p>
				<div class="day_error">{{ day_form.level.errors }}</div>
                <label>{{ day_form.level.label }}:</label>
                {{ day_form.level }}<br />
                <small>No backup full é feita uma cópia completa de todos os arquivos "marcados" para backup. No incremental é feita uma cópia apenas das modificações. É importamente sempre manter uma política mista de backups.</small>
            </p>
            <p>
				<input type="submit" class="submit" value="Salvar" /><a href="/procedures/list" class="submit small">Cancelar</a>
            </p>
        </div>		<!-- .sidebar_content ends -->

        <div class="sidebar_content" id="minuto">
            <div class="personal_message"><p>Executa o backup todas as horas do dia, sempre no minuto especificado.</p></div>
            <p>
				<div class="hour_error">{{ hour_form.minute.errors }}</div>
                <label>{{ hour_form.minute.label }}:</label>
                {{ hour_form.minute }}<br />
                <small>Exemplo: 20, 35 ou 08.</small>
            </p>
            <p>
				<div class="hour_error">{{ hour_form.level.errors }}</div>
                <label>{{ hour_form.level.label }}:</label>
                {{ hour_form.level }}<br />
                <small>No backup full é feita uma cópia completa de todos os arquivos "marcados" para backup. No incremental é feita uma cópia apenas das modificações. É importamente sempre manter uma política mista de backups.</small>
            </p>
            <p>
				<input type="submit" class="submit" value="Salvar" /><a href="/procedures/list" class="submit small">Cancelar</a>
            </p>
        </div>
        </form>
    </div>		<!-- .block_content ends -->


    <div class="bendl"></div>
    <div class="bendr"></div>

</div>		<!-- .block .schedule ends -->
{% endblock %}
