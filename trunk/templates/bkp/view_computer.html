{% extends "bkp/base.html" %}
{% load bkp_extras %}
{% block content %}
<!-- Begin Computers -->

{% if comp %}
	<h2>Computador <em>{{ comp.computer_name }}</em></h2>
	<p>IP: {{ comp.ip }}<br/>
	Descrição: {{ comp.description }}</p>

<h3>Últimos Procedimentos Executados</h3>

<table>
<thead>
	<tr>
	<th scope='col'>Job Id</th>
	<th scope='col'>FSet Id</th>
	<th scope='col'>Client</th>
	<th scope='col'>Job</th>
	<th scope='col'>Level</th>
	<th scope='col'>Status</th>
	<th scope='col'>Start</th>
	<th scope='col'>End</th>
	<th scope='col'>JobFiles</th>
	<th scope='col'>JobBytes</th>
	<th scope='col'>Errors</th>
	<th scope='col'></th>
	</tr>
</thead>
<tbody>
{% for job in lastjobs %}
<tr> 
{% for item in job %}
<td> {{ item }} </td>
{% endfor %}

{% if job|successful %}
<td> <form action="{{script_name}}/computer/{{comp.id}}/restore/" method="POST">
<input type="hidden" id="job_id" name="job_id" value="{{job|get_id}}" />
<input type="hidden" id="client_source" name="client_source" value="{{job|get_client_source}}" />
<input type="hidden" id="client_restore" name="client_restore" value="{{job|get_client_restore}}" />
<input type="hidden" id="client_restore" name="client_restore" value="{{job|get_fileset}}" />

<input type="submit" value="restaurar" />
</form> </td>
{% endif %}
</tr>
{% endfor %}
</tbody>
</table>


{% else %}
	<h2>Computadores</h2>
	<hr />
<!--  Expandable/Collapsible Area -->
	<h3>Adicionar Computador</h3>

<form action="{{script_name}}/computer/" method="post">
    {% for field in compform %}
        <div class="fieldWrapper">
            {{ field.errors }}
            {{ field.label_tag }}: {{ field }}
        </div>
    {% endfor %}
    <p><input type="submit" value="Salvar" /></p>
</form>
	<hr />
<!-- End Computers -->

{% endif %}

<!-- Begin Procedures -->
	<h3>Procedimentos</h3>
	{% if comp.procedure_set.count %}
    	<ul>
        	{% for p in comp.procedure_set.all %}
            	<form class="link" action="{{script_name}}/computer/{{comp.id}}/procedure/{{p.id}}/delete" method="post">
            	<li><a href="{{script_name}}/computer/{{comp.id}}/procedure/{{p.id}}">{{ p.procedure_name }}</a> | 
            	<a href="{{script_name}}/computer/{{comp.id}}/procedure/{{p.id}}/edit">Alterar</a>  |
            	<button type="submit">Remover</button>
            	</li></form>
        	{% endfor %}
    	</ul>
	{% else %}
	<p>Não há procedimentos para este computador.</p>
<!--  Expandable/Collapsible Area -->
	<h3>Adicionar Procedimento</h3>

	<form action="{{script_name}}/computer/{{comp.id}}/procedure/" method="post">
	    {% for field in procform %}
	        <div class="fieldWrapper">
	            {{ field.errors }}
	            {{ field.label_tag }}: {{ field }}
	        </div>
	    {% endfor %}
	    <p><input type="submit" value="Salvar" /></p>
	</form>

	<hr />
<!-- End Procedures -->
	{% endif %}
	
	<hr />

<!-- Begin FileSets -->
	<h2>Locais</h2>
	<p>Não há procedimento selecionado.</p>
	
	<hr />
<!-- End FileSets -->

<!-- Begin Schedules -->
	<h2>Agendamentos</h2>
	<p>Não há procedimento selecionado.</p>
	
	<hr />
<!-- End Schedules -->

<!-- Begin Triggers-->
	<h2>Detalhe Agendamento</h2>
	<p>Não há agendamento selecionado.</p>
<!-- End Triggers -->
{% endblock %}
